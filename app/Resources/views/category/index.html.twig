{% extends 'base.html.twig' %}

{% block body %}
    <h1>Categories list</h1>
    <ul>
        <li>
            <a href="{{ path('category_new') }}">Create a new category</a>
        </li>
    </ul>

    {% for category in categories %}
    {#{% macro recursiveCategory(category) %}#}
        {#{% import _self as self %}#}
        {#<li>#}
            {#<a href="">{{ category.name }}</a>#}

            {#{% if category.children|length %}#}
                {#<ul>#}
                    {#{% for child in category.children %}#}
        {# CHILDREN #}
        {% if category.children|length %}

            <hr class="bg-primary my-1">

            {% for c in category.children %}
                {% include 'snippets/category_snippet.html.twig' with {
                    'parentId': category.id,
                    'category': c
                } %}


                        <table>
                            <thead>
                            <tr>
                                <th>Id</th>
                                <th>Name</th>
                                <th>Actions</th>
                            </tr>
                            </thead>
                            <tbody>

                            <tr>
                                <td><a href="{{ path('category_show', { 'id': category.id }) }}">{{ category.id }}</a>
                                </td>
                                <td>{{ category.name }}</td>
                                <td>
                                    <ul>
                                        <li>
                                            <a href="{{ path('category_show', { 'id': category.id }) }}">show</a>
                                        </li>
                                        <li>
                                            <a href="{{ path('category_edit', { 'id': category.id }) }}">edit</a>
                                        </li>
                                    </ul>
                                </td>
                            </tr>

                            </tbody>
                        </table>
            {% endfor %}
        {% endif %}
                        {#{{ self.recursiveCategory(child) }}#}
                    {#{% endfor %}#}
                {#</ul>#}
            {#{% endif %}#}
        {#</li>#}
    {#{% endmacro %}#}

    {#{% from _self import recursiveCategory %}#}

    {#{% if categories %}#}
        {#<div id="categories">#}
            {#<ul>#}
                {#{% for category in categories %}#}
                    {#{{ recursiveCategory(category) }}#}
                    {#<table>#}
                        {#<thead>#}
                        {#<tr>#}
                            {#<th>Id</th>#}
                            {#<th>Name</th>#}
                            {#<th>Actions</th>#}
                        {#</tr>#}
                        {#</thead>#}
                        {#<tbody>#}

                        {#<tr>#}
                            {#<td><a href="{{ path('category_show', { 'id': category.id }) }}">{{ category.id }}</a></td>#}
                            {#<td>{{ category.name }}</td>#}
                            {#<td>#}
                                {#<ul>#}
                                    {#<li>#}
                                        {#<a href="{{ path('category_show', { 'id': category.id }) }}">show</a>#}
                                    {#</li>#}
                                    {#<li>#}
                                        {#<a href="{{ path('category_edit', { 'id': category.id }) }}">edit</a>#}
                                    {#</li>#}
                                {#</ul>#}
                            {#</td>#}
                        {#</tr>#}

                        {#</tbody>#}
                    {#</table>#}
                {#{% endfor %}#}
            {#</ul>#}
        {#</div>#}
    {#{% endif %}#}

    {#<table>#}
    {#<thead>#}
    {#<tr>#}
    {#<th>Id</th>#}
    {#<th>Name</th>#}
    {#<th>Actions</th>#}
    {#</tr>#}
    {#</thead>#}
    {#<tbody>#}

    {#<tr>#}
    {#<td><a href="{{ path('category_show', { 'id': category.id }) }}">{{ category.id }}</a></td>#}
    {#<td>{{ category.name }}</td>#}
    {#<td>#}
    {#<ul>#}
    {#<li>#}
    {#<a href="{{ path('category_show', { 'id': category.id }) }}">show</a>#}
    {#</li>#}
    {#<li>#}
    {#<a href="{{ path('category_edit', { 'id': category.id }) }}">edit</a>#}
    {#</li>#}
    {#</ul>#}
    {#</td>#}
    {#</tr>#}

    {#</tbody>#}
    {#</table>#}
    {% endfor %}

{% endblock body %}
